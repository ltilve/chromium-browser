<!DOCTYPE html>
<!--
Copyright (c) 2014 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<link rel="import" href="/tracing/core/test_utils.html">
<link rel="import" href="/tracing/model/event_set.html">
<link rel="import" href="/tracing/extras/chrome/user_friendly_category.html">

<script>
'use strict';

tr.b.unittest.testSuite(function() {
  test('userFriendlyCategory', function() {
    assert.equal(9, tr.e.chrome.UserFriendlyCategory.NAMES.length);

    var events = new tr.model.EventSet();
    var guid = 0;
    events.push({
      guid: guid++,
      title: 'FrameView::layout',
      category: 'cat'
    });
    events.push({
      guid: guid++,
      title: 'Script',
      category: 'cat'
    });
    events.push({
      guid: guid++,
      title: 'Paint',
      category: 'cat'
    });
    events.push({
      guid: guid++,
      title: 'Document::updateStyle',
      category: 'cat'
    });
    events.push({
      guid: guid++,
      title: 'HTMLDocumentParser::didReceiveParsedChunkFromBackgroundParser',
      category: 'cat'
    });
    events.push({
      guid: guid++,
      title: 'a',
      category: 'netlog'
    });
    events.push({
      guid: guid++,
      title: 'a',
      category: 'startup'
    });
    events.push({
      guid: guid++,
      title: 'a',
      category: 'foobar,overhead'
    });
    events.push({
      guid: guid++,
      title: 'a',
      category: 'other'
    });

    var eventsByCategory = events.getEventsOrganizedByCallback(
        tr.e.chrome.UserFriendlyCategory.fromEvent);

    tr.e.chrome.UserFriendlyCategory.NAMES.forEach(function(name) {
      assert.isDefined(eventsByCategory[name], name);
      assert.equal(1, eventsByCategory[name].length, name);
    });
  });
});
</script>
